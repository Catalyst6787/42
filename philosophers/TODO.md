TODO: add mutex for log
